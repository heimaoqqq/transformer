# å¾®å¤šæ™®å‹’æ—¶é¢‘å›¾æ•°æ®å¢žå¹¿é¡¹ç›®

åŸºäºŽ Diffusers çš„ä¸¤é˜¶æ®µæ‰©æ•£æ¨¡åž‹ï¼Œç”¨äºŽå¾®å¤šæ™®å‹’æ—¶é¢‘å›¾çš„æ•°æ®å¢žå¹¿ã€‚

## ðŸŽ¯ é¡¹ç›®æ¦‚è¿°

- **æ•°æ®é›†**: 256Ã—256 å½©è‰²å¾®å¤šæ™®å‹’æ—¶é¢‘å›¾åƒ
- **ç”¨æˆ·æ•°**: 31ä½ç”¨æˆ·çš„æ­¥æ€æ•°æ®
- **ç›®æ ‡**: é€šè¿‡æ¡ä»¶æ‰©æ•£ç”ŸæˆæŒ‡å®šç”¨æˆ·çš„æ­¥æ€å¾®å¤šæ™®å‹’æ—¶é¢‘å›¾åƒ
- **æŠ€æœ¯æ ˆ**: PyTorch + Diffusers + VAE + UNet

## ðŸ—ï¸ æŠ€æœ¯æ–¹æ¡ˆ

### ç¬¬ä¸€é˜¶æ®µ: VAE (å˜åˆ†è‡ªç¼–ç å™¨)
- å°† 256Ã—256 å›¾åƒç¼–ç åˆ°æ½œåœ¨ç©ºé—´ (32Ã—32Ã—4)
- å­¦ä¹ è¿žç»­çš„è§†è§‰è¡¨ç¤º
- åŽ‹ç¼©æ•°æ®ç»´åº¦ï¼Œæé«˜è®­ç»ƒæ•ˆçŽ‡
- ä½¿ç”¨ AutoencoderKL (Stable Diffusion åŒæ¬¾)

### ç¬¬äºŒé˜¶æ®µ: æ¡ä»¶æ‰©æ•£
- åœ¨æ½œåœ¨ç©ºé—´ä¸­è¿›è¡Œæ‰©æ•£è®­ç»ƒ
- ä»¥ç”¨æˆ·IDä½œä¸ºæ¡ä»¶ä¿¡æ¯ (äº¤å‰æ³¨æ„åŠ›)
- ç”ŸæˆæŒ‡å®šç”¨æˆ·çš„å¾®å¤šæ™®å‹’å›¾åƒ
- ä½¿ç”¨ UNet2DConditionModel

## ðŸš€ å¿«é€Ÿå¼€å§‹

### KaggleçŽ¯å¢ƒ (æŽ¨è)

å¦‚æžœæ‚¨åœ¨Kaggleä¸Šè¿è¡Œï¼Œä½¿ç”¨ä¸“ç”¨è„šæœ¬ï¼š

```bash
# ä¸€é”®è®­ç»ƒ (é€‚é…æ‚¨çš„æ•°æ®é›†ç»“æž„)
python train_kaggle.py --stage all

# æŸ¥çœ‹è¯¦ç»†è¯´æ˜Ž
cat KAGGLE_README.md
```

### æœ¬åœ°çŽ¯å¢ƒ

#### 1. çŽ¯å¢ƒè®¾ç½®
```bash
# è‡ªåŠ¨è®¾ç½®çŽ¯å¢ƒ
python setup_environment.py

# æˆ–æ‰‹åŠ¨å®‰è£…
pip install -r requirements.txt
```

#### 2. æµ‹è¯•çŽ¯å¢ƒ
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•
python test_pipeline.py

# æµ‹è¯•ç‰¹å®šç»„ä»¶
python test_pipeline.py --test data
```

#### 3. å‡†å¤‡æ•°æ®
æ”¯æŒä¸¤ç§æ•°æ®ç»“æž„ï¼š

**Kaggleæ ¼å¼** (æ‚¨çš„æ•°æ®é›†):
```
/kaggle/input/dataset/
â”œâ”€â”€ ID_1/
â”œâ”€â”€ ID_2/
â””â”€â”€ ID_31/
```

**æ ‡å‡†æ ¼å¼**:
```
data/
â”œâ”€â”€ user_01/
â”œâ”€â”€ user_02/
â””â”€â”€ user_31/
```

#### 4. è®­ç»ƒæ¨¡åž‹

**KaggleçŽ¯å¢ƒ**:
```bash
# ä½¿ç”¨ä¼˜åŒ–çš„Kaggleé…ç½®
python train_kaggle.py --stage all
```

**æœ¬åœ°çŽ¯å¢ƒ**:
```bash
# ç¬¬ä¸€é˜¶æ®µ: VAEè®­ç»ƒ
python training/train_vae.py --data_dir ./data --output_dir ./outputs/vae

# ç¬¬äºŒé˜¶æ®µ: æ¡ä»¶æ‰©æ•£è®­ç»ƒ
python training/train_diffusion.py \
    --data_dir ./data \
    --vae_path ./outputs/vae/final_model \
    --output_dir ./outputs/diffusion
```

#### 5. ç”Ÿæˆå›¾åƒ
```bash
# ç”ŸæˆæŒ‡å®šç”¨æˆ·çš„å›¾åƒ
python inference/generate.py \
    --vae_path ./outputs/vae/final_model \
    --unet_path ./outputs/diffusion/final_model/unet \
    --condition_encoder_path ./outputs/diffusion/final_model/condition_encoder.pt \
    --num_users 31 \
    --user_ids 1 5 10 \
    --num_images_per_user 5
```

## ðŸ“ é¡¹ç›®ç»“æž„

```
â”œâ”€â”€ data/                   # æ•°æ®é›†ç›®å½•
â”œâ”€â”€ training/              # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ train_vae.py      # VAEè®­ç»ƒ
â”‚   â””â”€â”€ train_diffusion.py # æ¡ä»¶æ‰©æ•£è®­ç»ƒ
â”œâ”€â”€ inference/             # æŽ¨ç†è„šæœ¬
â”‚   â””â”€â”€ generate.py       # æ¡ä»¶ç”Ÿæˆ
â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ data_loader.py    # æ•°æ®åŠ è½½å™¨
â”‚   â””â”€â”€ metrics.py        # è¯„ä¼°æŒ‡æ ‡
â”œâ”€â”€ outputs/               # è®­ç»ƒè¾“å‡º
â”œâ”€â”€ TRAINING_GUIDE.md      # è¯¦ç»†è®­ç»ƒæŒ‡å—
â”œâ”€â”€ test_pipeline.py       # æµ‹è¯•è„šæœ¬
â””â”€â”€ setup_environment.py   # çŽ¯å¢ƒè®¾ç½®
```

## ðŸ“‹ çŽ¯å¢ƒè¦æ±‚

- **Python**: 3.8+
- **PyTorch**: 2.0+
- **GPU**: 8GB+ VRAM (æŽ¨è16GB)
- **CUDA**: 11.8+
- **ä¾èµ–**: è§ requirements.txt

## ðŸ“Š æ€§èƒ½åŸºå‡†

| é…ç½® | GPUå†…å­˜ | è®­ç»ƒæ—¶é—´ | æ‰¹æ¬¡å¤§å° |
|------|---------|----------|----------|
| æœ€ä½Ž | 8GB | VAE: 3å¤©, æ‰©æ•£: 5å¤© | 4 |
| æŽ¨è | 16GB | VAE: 2å¤©, æ‰©æ•£: 3å¤© | 8 |
| é«˜ç«¯ | 24GB+ | VAE: 1å¤©, æ‰©æ•£: 2å¤© | 16+ |

## ðŸŽ¯ é¢„æœŸç»“æžœ

- **VAEé‡å»ºPSNR**: > 25 dB
- **VAEé‡å»ºSSIM**: > 0.8
- **FIDåˆ†æ•°**: < 50
- **æ¡ä»¶æŽ§åˆ¶**: å‡†ç¡®ç”ŸæˆæŒ‡å®šç”¨æˆ·ç‰¹å¾

## ðŸ“– è¯¦ç»†æ–‡æ¡£

- **[Kaggleä¸“ç”¨æŒ‡å—](KAGGLE_README.md)** - é’ˆå¯¹æ‚¨çš„æ•°æ®é›†çš„ä¼˜åŒ–é…ç½®
- **[å¾®å¤šæ™®å‹’æ•°æ®å¢žå¹¿è¯´æ˜Ž](MICRO_DOPPLER_AUGMENTATION.md)** - æ•°æ®å¢žå¹¿ vs ä¼ ç»Ÿå¢žå¼º
- [å®Œæ•´è®­ç»ƒæŒ‡å—](TRAINING_GUIDE.md) - è¯¦ç»†çš„è®­ç»ƒæ­¥éª¤å’Œå‚æ•°è°ƒä¼˜
- [æŠ€æœ¯åˆ†æž](technical_analysis.md) - æ¨¡åž‹æž¶æž„è¯¦ç»†åˆ†æž
- [VAE vs VQ-VAEå¯¹æ¯”](vae_vs_vqvae_analysis.md) - æŠ€æœ¯é€‰æ‹©åˆ†æž

## ðŸ”§ æ•…éšœæŽ’é™¤

å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š

1. **CUDAå†…å­˜ä¸è¶³**: å‡å°batch_sizeï¼Œä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒ
2. **VAEé‡å»ºæ¨¡ç³Š**: è°ƒæ•´KLæƒé‡å’Œæ„ŸçŸ¥æŸå¤±æƒé‡
3. **æ‰©æ•£è®­ç»ƒä¸æ”¶æ•›**: é™ä½Žå­¦ä¹ çŽ‡ï¼Œå¢žåŠ è®­ç»ƒæ­¥æ•°
4. **ç”Ÿæˆè´¨é‡å·®**: å¢žåŠ æŽ¨ç†æ­¥æ•°ï¼Œè°ƒæ•´å¼•å¯¼å¼ºåº¦

## ðŸ¤ è´¡çŒ®

æ¬¢è¿Žæäº¤Issueå’ŒPull Requestï¼

## ðŸ“„ è®¸å¯è¯

MIT License
